[
  {
    "id": "conditional_branch",
    "name": "Conditional Branch (If/Else)",
    "description": "Route pipeline execution to different branches based on a condition expression",
    "category": "control",
    "organ": "system",
    "input_schema": {
      "type": "object",
      "properties": {
        "condition": { "type": "string", "description": "Expression to evaluate (e.g. '{{prev.price}} < 400')" },
        "value": { "description": "The value to check (alternative to condition expression)" }
      },
      "required": ["condition"]
    },
    "output_schema": {
      "type": "object",
      "properties": {
        "branch": { "type": "string", "enum": ["true", "false"], "description": "Which branch to take" },
        "evaluated_value": { "description": "The value that was evaluated" }
      }
    },
    "api_type": "real",
    "tier": 1,
    "examples": [
      { "input": { "condition": "price < 400", "value": 399 }, "output": { "branch": "true", "evaluated_value": 399 } }
    ]
  },
  {
    "id": "filter_threshold",
    "name": "Threshold Filter",
    "description": "Check if a numeric value is above or below a threshold",
    "category": "control",
    "organ": "system",
    "input_schema": {
      "type": "object",
      "properties": {
        "value": { "type": "number", "description": "The value to check" },
        "threshold": { "type": "number", "description": "The threshold value" },
        "operator": { "type": "string", "enum": ["<", "<=", ">", ">=", "==", "!="], "default": "<" }
      },
      "required": ["value", "threshold"]
    },
    "output_schema": {
      "type": "object",
      "properties": {
        "passes": { "type": "boolean", "description": "Whether the value passes the threshold check" },
        "value": { "type": "number" },
        "threshold": { "type": "number" },
        "difference": { "type": "number" }
      }
    },
    "api_type": "real",
    "tier": 1,
    "examples": [
      { "input": { "value": 399, "threshold": 400, "operator": "<" }, "output": { "passes": true, "value": 399, "threshold": 400, "difference": -1 } }
    ]
  },
  {
    "id": "data_transform",
    "name": "Transform Data",
    "description": "Reshape or map data fields from one format to another using a field mapping",
    "category": "control",
    "organ": "system",
    "input_schema": {
      "type": "object",
      "properties": {
        "data": { "type": "object", "description": "Input data to transform" },
        "mapping": { "type": "object", "description": "Field mapping: { new_field: source_expression }", "additionalProperties": { "type": "string" } }
      },
      "required": ["data", "mapping"]
    },
    "output_schema": {
      "type": "object",
      "properties": {
        "transformed": { "type": "object", "description": "The transformed data" }
      }
    },
    "api_type": "real",
    "tier": 1,
    "examples": [
      { "input": { "data": { "product_name": "PS5", "product_price": 399 }, "mapping": { "name": "product_name", "cost": "product_price" } }, "output": { "transformed": { "name": "PS5", "cost": 399 } } }
    ]
  },
  {
    "id": "loop_for_each",
    "name": "For-Each Loop",
    "description": "Execute a block for each item in a list and collect all results",
    "category": "control",
    "organ": "system",
    "input_schema": {
      "type": "object",
      "properties": {
        "items": { "type": "array", "description": "List of items to iterate over" },
        "block_id": { "type": "string", "description": "Block to execute for each item" }
      },
      "required": ["items", "block_id"]
    },
    "output_schema": {
      "type": "object",
      "properties": {
        "results": { "type": "array", "description": "Collected results from each iteration" },
        "count": { "type": "integer" }
      }
    },
    "api_type": "real",
    "tier": 1,
    "examples": [
      { "input": { "items": ["url1", "url2", "url3"], "block_id": "web_scrape" }, "output": { "results": [{ "text": "..." }, { "text": "..." }, { "text": "..." }], "count": 3 } }
    ]
  },
  {
    "id": "data_diff",
    "name": "Data Diff",
    "description": "Compare two datasets and return what changed (added, removed, modified)",
    "category": "control",
    "organ": "system",
    "input_schema": {
      "type": "object",
      "properties": {
        "old_data": { "description": "Previous version of the data" },
        "new_data": { "description": "Current version of the data" }
      },
      "required": ["old_data", "new_data"]
    },
    "output_schema": {
      "type": "object",
      "properties": {
        "has_changes": { "type": "boolean" },
        "added": { "type": "array" },
        "removed": { "type": "array" },
        "modified": { "type": "array" },
        "summary": { "type": "string" }
      }
    },
    "api_type": "real",
    "tier": 1,
    "examples": [
      { "input": { "old_data": { "price": 499 }, "new_data": { "price": 399 } }, "output": { "has_changes": true, "added": [], "removed": [], "modified": [{ "field": "price", "old": 499, "new": 399 }], "summary": "price changed from 499 to 399" } }
    ]
  }
]
